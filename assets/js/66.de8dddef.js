(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{546:function(a,s,t){"use strict";t.r(s);var e=t(4),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[a._v("#")]),a._v(" 前言")]),a._v(" "),t("p",[a._v("作为数据工作者，离不开excel表数据的操作，此文主要来讲下工作通常会用到函数或操作")]),a._v(" "),t("p",[t("strong",[a._v("常见函数分类")])]),a._v(" "),t("ul",[t("li",[t("p",[a._v("文本清洗函数")])]),a._v(" "),t("li",[t("p",[a._v("关联匹配函数")])]),a._v(" "),t("li",[t("p",[a._v("逻辑运算函数")])]),a._v(" "),t("li",[t("p",[a._v("计算统计函数")])]),a._v(" "),t("li",[t("p",[a._v("时间序列函数")])])]),a._v(" "),t("h2",{attrs:{id:"文本清洗函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文本清洗函数"}},[a._v("#")]),a._v(" 文本清洗函数")]),a._v(" "),t("p",[a._v("1.常用的文本清洗函数")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("清除字符串空格：TRIM")])]),a._v(" "),t("li",[t("p",[a._v("合并单元格：CONCATENATE")])]),a._v(" "),t("li",[t("p",[a._v("截取字符串：LEFT / RIGHT / MID")])]),a._v(" "),t("li",[t("p",[a._v("替换单元格中的内容：REPLACE / SUBSTITUTE")])]),a._v(" "),t("li",[t("p",[a._v("查找文本在单元格中的位置：FIND / SEARCH")])])]),a._v(" "),t("p",[a._v("2.清除字符串空格")]),a._v(" "),t("p",[t("strong",[a._v("TRIM")]),a._v("：清除字符串text左右的空格")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=TRIM(text)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("TRIM(去掉前后空格) 和 SUBSTITUDE(去空格,包括字符串之间的空格)")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/10/TRIM.jpg",alt:"TRIM"}})]),a._v(" "),t("p",[a._v("3.合并单元格")]),a._v(" "),t("p",[t("strong",[a._v("CONCATENATE")]),a._v("：将几个文本字符串合并为一个文本字符串。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=CONCATENATE(text1, text2, ...)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("CONCATENATE 和 &")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/10/CONCATENATE.jpg",alt:"CONCATENATE"}})]),a._v(" "),t("p",[t("strong",[a._v("4.截取字符串")])]),a._v(" "),t("p",[t("strong",[a._v("MID:")]),a._v(" 从text中，从stat_num开始，提取num_chars个字符串。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=MID(text, start_num, num_chars)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/mid.jpg",alt:"mid"}})]),a._v(" "),t("p",[t("strong",[a._v("LEFT:")]),a._v(" 从text中，提取num_chars个字符（从左开始）。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=LEFT(text, num_cahrs)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("strong",[a._v("RIGHT:")]),a._v(" 从text中，提取num_chars个字符（从右开始）")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=RIGHT(text, num_chars)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/left&right.jpg",alt:"left&right"}})]),a._v(" "),t("p",[t("strong",[a._v("5.替换单元格中内容")])]),a._v(" "),t("p",[t("strong",[a._v("REPLACE：")]),a._v(" 替换指定位置，从“原字符串”的“开始位置”开始，选择“字符个数”个，替换为“新字符串”。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=REPLACE(原字符串, 开始位置, 字符个数, 新字符串)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/REPLACE.jpg",alt:"REPLACE"}})]),a._v(" "),t("p",[t("strong",[a._v("SUBSTITUTE：")]),a._v(" 替换指定文本，在text中用new_text替换old_text，instance_num指定要替换第几次出现的old_text，如果不指定则替换old_text。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=SUBSTITUTE(text, old_text, new_text, instance_num)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/SUBSTITUTE.jpg",alt:"SUBSTITUTE"}})]),a._v(" "),t("p",[t("strong",[a._v("6.查找文本在单元格中的位置")])]),a._v(" "),t("p",[t("strong",[a._v("FIND & SEARCH：")]),a._v(" 从within_test中查找FIND_text，返回查找字符的起始位置编号。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=FIND(FIND_text, within_text, start_num)\n\n=SEARCH(要查找字符, 字符所在的文本, 从第几个字符开始查找)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("FIND 和 SEARCH 两个函数几乎相同，区别在于FIND 精确查找，区分大小写；SEARCH 模糊查找，不区分大小写。")]),a._v(" "),t("p",[a._v("FIND,SEARCH,MID综合使用\n"),t("img",{attrs:{src:"/images/202009/10/find&search&mid.jpg",alt:"find&search&mid"}})]),a._v(" "),t("h2",{attrs:{id:"关联匹配函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关联匹配函数"}},[a._v("#")]),a._v(" 关联匹配函数")]),a._v(" "),t("h3",{attrs:{id:"vlookup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vlookup"}},[a._v("#")]),a._v(" VLOOKUP")]),a._v(" "),t("p",[a._v("函数总共有4个参数，分别是："),t("strong",[a._v("用谁去找")]),a._v("、"),t("strong",[a._v("匹配对象范围")]),a._v("、"),t("strong",[a._v("返回第几列")]),a._v("、"),t("strong",[a._v("匹配方式")]),a._v("（0/FALSE表示精确匹配，1/TRUE表示模糊匹配）。")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/10/vlookup1.jpg",alt:"vlookup1"}})]),a._v(" "),t("p",[a._v("四种查询方式")]),a._v(" "),t("p",[t("strong",[a._v("单条件查找")])]),a._v(" "),t("p",[a._v("根据工号，将左边检索区域的“电脑销售额”匹配到右边对应位置，只需要使用VLOOKUP函数，结果存在则显示对应的“电脑销售额”；结果不存在则显示#N/A。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=VLOOKUP(F2,$A$2:$D$55,4,0)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/vlookup2.jpg",alt:"vlookup2"}})]),a._v(" "),t("p",[t("strong",[a._v("反向查找")])]),a._v(" "),t("p",[a._v("当检索关键字不在检索区域的第1列，可以使用虚拟数组公式IF来做一个调换。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=VLOOKUP(检索关键字，IF({1,0},检索关键字所在列，查找值所在列)，2，0)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/vlookup3.jpg",alt:"vlookup3"}})]),a._v(" "),t("p",[t("strong",[a._v("多条件查询")])]),a._v(" "),t("p",[a._v("在匹配数据时，往往条件不是单一的，那么就可以利用&将字段拼接起来，并且利用IF数组公式构建出一个虚拟的区域。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=VLOOKUP(F2&G2,IF({1,0},A2:A53&B2:B53,D2:D53),2,0)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/10/vlookup4.jpg",alt:"vlookup4"}})]),a._v(" "),t("blockquote",[t("p",[a._v("注意：所有使用了数组的公式，不能直接回车，需要使用Ctrl+Shift+Enter，否则会出错。")])]),a._v(" "),t("p",[t("strong",[a._v("查询返回多列")])]),a._v(" "),t("p",[a._v("COLUMN")]),a._v(" "),t("p",[a._v("查找返回多列需要用到另外一个辅助函数——COLUMN函数。")]),a._v(" "),t("p",[a._v("返回结果为单元格引用的列数。例如：column(B1)返回值为2，因为B1为第2列。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=COLUMN(待查询单元格/区域)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("需要注意的是第三个参数“返回第几列”的写法。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=VLOOKUP($G2,$A$2:$E$55,COLUMN(D1),0)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"hlookup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hlookup"}},[a._v("#")]),a._v(" HLOOKUP")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=HLOOKUP(用谁去找, 匹配对象范围, 返回第几行, 匹配方式)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("和VLOOKUP的区别：HLOOKUP返回的值与查找的值在同一列上，而VLOOKUP返回的值与查找的值在同一行上。")]),a._v(" "),t("h3",{attrs:{id:"index"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#index"}},[a._v("#")]),a._v(" INDEX")]),a._v(" "),t("p",[a._v("返回数组array中指定索引的单元格的值。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=INDEX(array, Row_num, Column_num)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/11/index.jpg",alt:"index"}})]),a._v(" "),t("h3",{attrs:{id:"match"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#match"}},[a._v("#")]),a._v(" MATCH")]),a._v(" "),t("ul",[t("li",[a._v("功能：在区域内查找指定的值，返回第一个查找值的位置。")]),a._v(" "),t("li",[a._v("lookup_value：需要查找的值。")]),a._v(" "),t("li",[a._v("lookup_array：查找的区域。")]),a._v(" "),t("li",[a._v("match_type：-1、0或1，0表示查找等于lookup_value的值。")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=MATCH(lookup_value, lookup_array, [match_type])\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/11/match.jpg",alt:"match"}})]),a._v(" "),t("p",[t("strong",[a._v("Index & Match联合使用 = VLookup")])]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/index&match.jpg",alt:"index&match"}})]),a._v(" "),t("h3",{attrs:{id:"row-column"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#row-column"}},[a._v("#")]),a._v(" ROW & COLUMN")]),a._v(" "),t("ul",[t("li",[a._v("ROW：返回指定引用的行号。")]),a._v(" "),t("li",[a._v("COLUMN：返回指定引用的列号。")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=ROW(reference)\n=COLUMN(reference)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h3",{attrs:{id:"offset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#offset"}},[a._v("#")]),a._v(" OFFSET")]),a._v(" "),t("ul",[t("li",[a._v("OFFSET：以指定的引用reference为起点，按照偏移量偏移之后，返回值。")]),a._v(" "),t("li",[a._v("rows：向下偏移多少行。")]),a._v(" "),t("li",[a._v("columns：向右偏移多少列。")]),a._v(" "),t("li",[a._v("height：返回多少行。")]),a._v(" "),t("li",[a._v("width：返回多少列。")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=OFFSET(reference,rows,columns,height,width)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/11/offset1.jpg",alt:"offset1"}})]),a._v(" "),t("p",[a._v("计算返回的两行两列的和")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/offset2.jpg",alt:"offset2"}})]),a._v(" "),t("h3",{attrs:{id:"hyperlink"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hyperlink"}},[a._v("#")]),a._v(" HYPERLINK")]),a._v(" "),t("p",[a._v("创建一个超链接指向link_location，以friendly_name的字符串进行显示，link_location可以是URL链接或文件路径。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=HYPERLINK(link_location, friendly_name)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/202009/11/hyperlink.jpg",alt:"hyperlink"}})]),a._v(" "),t("h2",{attrs:{id:"逻辑运算函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#逻辑运算函数"}},[a._v("#")]),a._v(" 逻辑运算函数")]),a._v(" "),t("h3",{attrs:{id:"if"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#if"}},[a._v("#")]),a._v(" IF")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/if.jpg",alt:"if"}})]),a._v(" "),t("p",[a._v("对应函数")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('=IF(AND(B13=1,C13=1)=TRUE,"男神",IF(AND(B13=1,C13=0)=TRUE,"靠脸吃饭",IF(AND(B13=0,C13=1)=TRUE,"肌肉男","是个好人")))\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"averageif"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#averageif"}},[a._v("#")]),a._v(" AVERAGEIF")]),a._v(" "),t("p",[t("code",[a._v("=AVERAGEIF($D$4:$D$1046,H5,$F$4:$F$1046)")])]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/24/averageif.png",alt:"averageif"}})]),a._v(" "),t("h2",{attrs:{id:"计算统计函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#计算统计函数"}},[a._v("#")]),a._v(" 计算统计函数")]),a._v(" "),t("h3",{attrs:{id:"求最值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#求最值"}},[a._v("#")]),a._v(" 求最值")]),a._v(" "),t("p",[a._v("MAX MIN")]),a._v(" "),t("ul",[t("li",[a._v("MAX：求某区域中的最大值。")]),a._v(" "),t("li",[a._v("MIN：求某区域中的最小值。")])]),a._v(" "),t("h3",{attrs:{id:"求数目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#求数目"}},[a._v("#")]),a._v(" 求数目")]),a._v(" "),t("p",[a._v("COUNT COUNTIF COUNTIFS")]),a._v(" "),t("ul",[t("li",[a._v("COUNT：计数")]),a._v(" "),t("li",[a._v("COUNTIF：单条件计数")]),a._v(" "),t("li",[a._v("COUNTIFS：多条件计数")])]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("=COUNTIF(区域, 条件)\n=COUNTIFS(区域1, 条件1, [区域2, 条件2], ...)\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("单条件计数")]),a._v(" "),t("p",[a._v("例1")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/countif.jpg",alt:"countif"}})]),a._v(" "),t("p",[a._v("例2")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/24/countif.png",alt:"countif2"}})]),a._v(" "),t("p",[a._v("多条件计数")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/countifs.jpg",alt:"countifs"}})]),a._v(" "),t("p",[a._v("COUNT(统计目标区域有多少个数值类型的单元格)")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/count.jpg",alt:"count"}})]),a._v(" "),t("p",[a._v("COUNTA(统计所有非空单元格个数) 和 COUNTBLANK(统计空白单元格个数)")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/14/COUNTA.png",alt:"COUNTA"}})]),a._v(" "),t("h3",{attrs:{id:"求和"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#求和"}},[a._v("#")]),a._v(" 求和")]),a._v(" "),t("p",[a._v("SUM")]),a._v(" "),t("p",[a._v("功能：计算单元格区域中所有数值的和。")]),a._v(" "),t("p",[a._v("SUMIF")]),a._v(" "),t("p",[a._v("功能：求满足条件的单元格的和。")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/sumif.jpg",alt:"sumif"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/202009/11/sumif2.jpg",alt:"sumif2"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);