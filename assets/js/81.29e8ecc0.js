(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{561:function(s,a,n){"use strict";n.r(a);var e=n(4),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h4",{attrs:{id:"创建项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建项目"}},[s._v("#")]),s._v(" 创建项目:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("scrappy start project maitian\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"明确要抓取的字段items-py"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#明确要抓取的字段items-py"}},[s._v("#")]),s._v(" 明确要抓取的字段items.py")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import scrapy\n\nclass MaitianItem(scrapy.Item):\n    # define the fields for your item here like:\n    # name = scrapy.Field()\n    title = scrapy.Field()\n    price = scrapy.Field()\n    area = scrapy.Field()\n    district = scrapy.Field()\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"在spider目录下创建爬虫文件-zufang-spider-py"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在spider目录下创建爬虫文件-zufang-spider-py"}},[s._v("#")]),s._v(" 在spider目录下创建爬虫文件: zufang_spider.py")]),s._v(" "),n("p",[s._v("2.1 创建一个类，并继承scrapy的一个子类: "),n("code",[s._v("scrapy.Spider")]),s._v("\n2.2 自定义爬取名,  "),n("code",[s._v('name=""')]),s._v(" 后面运行框架需要用到；\n2.3 定义爬取目标网址\n2.4 定义scrapy的方法")]),s._v(" "),n("p",[s._v("下面是简单项目:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import scrapy\nfrom maitian.items import MaitianItem\n\nclass MaitianSpider(scrapy.Spider):\n    name = \"zufang\"\n    start_urls = ['http://bj.maitian.cn/zfall/PG1']\n\n    def parse(self, response):\n        for zufang_itme in response.xpath('//div[@class=\"list_title\"]'):\n            yield {\n                'title': zufang_itme.xpath('./h1/a/text()').extract_first().strip(),\n                'price': zufang_itme.xpath('./div[@class=\"the_price\"]/ol/strong/span/text()').extract_first().strip(),\n                'area': zufang_itme.xpath('./p/span/text()').extract_first().replace('㎡', '').strip(),\n                'district': zufang_itme.xpath('./p//text()').re(r'昌平|朝阳|东城|大兴|丰台|海淀|石景山|顺义|通州|西城')[0],\n            }\n\n        next_page_url = response.xpath(\n            '//div[@id=\"paging\"]/a[@class=\"down_page\"]/@href').extract_first()\n        if next_page_url is not None:\n            yield scrapy.Request(response.urljoin(next_page_url))\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h4",{attrs:{id:"在settings-py文件中设置数据保存到数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在settings-py文件中设置数据保存到数据库"}},[s._v("#")]),s._v(" 在settings.py文件中设置数据保存到数据库")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(".\n.\n.\n\nITEM_PIPELINES = {'maitian.pipelines.MaitianPipeline': 300,}\n\nMONGODB_HOST = '127.0.0.1'\nMONGODB_PORT = 27017\nMONGODB_DBNAME = 'maitian'\nMONGODB_DOCNAME = 'zufang'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"通过管道pipelines-py连接上面的操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过管道pipelines-py连接上面的操作"}},[s._v("#")]),s._v(" 通过管道pipelines.py连接上面的操作")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import pymongo\nfrom scrapy.conf import settings\n\nclass MaitianPipeline(object):\n    def __init__(self):\n        host = settings['MONGODB_HOST']\n        port = settings['MONGODB_PORT']\n        db_name = settings['MONGODB_DBNAME']\n        client = pymongo.MongoClient(host=host, port=port)\n        db = client[db_name]\n        self.post = db[settings['MONGODB_DOCNAME']]\n\n    def process_item(self, item, spider):\n        zufang = dict(item)\n        self.post.insert(zufang)\n        return item\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("其中 middlewares.py 文件暂不处理")]),s._v(" "),n("p",[s._v("以上简单的scrapy爬虫项目搭建完毕了")])])}),[],!1,null,null,null);a.default=t.exports}}]);