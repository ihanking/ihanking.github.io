---
title: ç›¸å…³åˆ†æ|é€»è¾‘å›å½’åˆ†ç±»
date: 2020-09-27
draft: false
tags: ["sklearn"]
categories: ["æœºå™¨å­¦ä¹ "]
---

## å»ºç«‹æ•°æ®é›†

```python
from collections import OrderedDict
import pandas as pd

#æ•°æ®é›†
examDict={
    'å­¦ä¹ æ—¶é—´':[0.50,0.75,1.00,1.25,1.50,1.75,1.75,2.00,2.25,2.50,
            2.75,3.00,3.25,3.50,4.00,4.25,4.50,4.75,5.00,5.50],
    'é€šè¿‡è€ƒè¯•':[0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1]
}
examOrderDict=OrderedDict(examDict)
examDf=pd.DataFrame(examOrderDict)

examDf.head()
```
![examdf_head](/images/202009/27/examdf_head.jpg)

## æå–ç‰¹å¾å’Œæ ‡ç­¾

```python
#ç‰¹å¾features
exam_X=examDf.loc[:,'å­¦ä¹ æ—¶é—´']
#æ ‡ç­¾labes
exam_y=examDf.loc[:,'é€šè¿‡è€ƒè¯•']
```

## ç»˜åˆ¶æ•£ç‚¹å›¾

```python
import matplotlib.pyplot as plt

#æ•£ç‚¹å›¾
plt.scatter(exam_X, exam_y, color="b", label="exam data")

#æ·»åŠ å›¾æ ‡æ ‡ç­¾
plt.xlabel("Hours")
plt.ylabel("Pass")
#æ˜¾ç¤ºå›¾åƒ
plt.show()
```
![é€»è¾‘å›å½’æ•£ç‚¹å›¾1](/images/202009/27/é€»è¾‘å›å½’æ•£ç‚¹å›¾1.png)

## å»ºç«‹è®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†

```python
'''
train_test_splitæ˜¯äº¤å‰éªŒè¯ä¸­å¸¸ç”¨çš„å‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯ä»æ ·æœ¬ä¸­éšæœºçš„æŒ‰æ¯”ä¾‹é€‰å–è®­ç»ƒæ•°æ®ï¼ˆtrainï¼‰å’Œæµ‹è¯•æ•°æ®ï¼ˆtestï¼‰
ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ‰€è¦åˆ’åˆ†çš„æ ·æœ¬ç‰¹å¾
ç¬¬2ä¸ªå‚æ•°ï¼šæ‰€è¦åˆ’åˆ†çš„æ ·æœ¬æ ‡ç­¾
train_sizeï¼šè®­ç»ƒæ•°æ®å æ¯”ï¼Œå¦‚æœæ˜¯æ•´æ•°çš„è¯å°±æ˜¯æ ·æœ¬çš„æ•°é‡
'''

'''
sklearnåŒ…0.8ç‰ˆæœ¬ä»¥åï¼Œéœ€è¦å°†ä¹‹å‰çš„sklearn.cross_validation æ¢æˆsklearn.model_selection
æ‰€ä»¥è¯¾ç¨‹ä¸­çš„ä»£ç 
from sklearn.cross_validation import train_test_split 
æ›´æ–°ä¸ºä¸‹é¢çš„ä»£ç 
'''
from sklearn.model_selection import train_test_split

#å»ºç«‹è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®
X_train , X_test , y_train , y_test = train_test_split(exam_X ,
                                                       exam_y ,
                                                       train_size = .8)
#è¾“å‡ºæ•°æ®å¤§å°
print('åŸå§‹æ•°æ®ç‰¹å¾ï¼š',exam_X.shape ,
      'ï¼Œè®­ç»ƒæ•°æ®ç‰¹å¾ï¼š', X_train.shape , 
      'ï¼Œæµ‹è¯•æ•°æ®ç‰¹å¾ï¼š',X_test.shape )

print('åŸå§‹æ•°æ®æ ‡ç­¾ï¼š',exam_y.shape ,
      'è®­ç»ƒæ•°æ®æ ‡ç­¾ï¼š', y_train.shape ,
      'æµ‹è¯•æ•°æ®æ ‡ç­¾ï¼š' ,y_test.shape)
```
```
åŸå§‹æ•°æ®ç‰¹å¾ï¼š (20,) ï¼Œè®­ç»ƒæ•°æ®ç‰¹å¾ï¼š (16,) ï¼Œæµ‹è¯•æ•°æ®ç‰¹å¾ï¼š (4,)
åŸå§‹æ•°æ®æ ‡ç­¾ï¼š (20,) è®­ç»ƒæ•°æ®æ ‡ç­¾ï¼š (16,) æµ‹è¯•æ•°æ®æ ‡ç­¾ï¼š (4,)
```

```python
#ç»˜åˆ¶æ•£ç‚¹å›¾
import matplotlib.pyplot as plt

#æ•£ç‚¹å›¾
plt.scatter(X_train, y_train, color="blue", label="train data")
plt.scatter(X_test, y_test, color="red", label="test data")

#æ·»åŠ å›¾æ ‡æ ‡ç­¾
plt.legend(loc=2)
plt.xlabel("Hours")
plt.ylabel("Pass")
#æ˜¾ç¤ºå›¾åƒ
plt.show()
```
![é€»è¾‘å›å½’æ•£ç‚¹å›¾2](/images/202009/27/é€»è¾‘å›å½’æ•£ç‚¹å›¾2.png)

## è®­ç»ƒæ¨¡å‹ï¼ˆä½¿ç”¨è®­ç»ƒæ•°æ®ï¼‰

```python
'''
è¿è¡Œåä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™é‡Œè¾“å…¥çš„ç‰¹å¾åªæœ‰1ä¸ªã€‚æ³¨æ„çœ‹æŠ¥é”™ä¿¡æ¯ï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­ä¹Ÿå­¦ä¼šå¦‚ä½•åˆ†ææŠ¥é”™ä¿¡æ¯
'''
#ç¬¬1æ­¥ï¼šå¯¼å…¥é€»è¾‘å›å½’
from sklearn.linear_model import LogisticRegression
# ç¬¬2æ­¥ï¼šåˆ›å»ºæ¨¡å‹ï¼šé€»è¾‘å›å½’
model = LogisticRegression()
#ç¬¬3æ­¥ï¼šè®­ç»ƒæ¨¡å‹
model.fit(X_train , y_train)
```

è¿è¡Œä¸Šé¢ç¨‹åºä¼šæŠ¥é”™ï¼š

```
ValueError: Expected 2D array, got 1D array instead:
array=[4.   2.25 1.5  4.5  1.75 3.5  1.25 4.25 5.5  1.75 2.   3.25 0.75 3.
 2.5  5.  ].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.

'''
ä¸Šé¢çš„æŠ¥é”™å†…å®¹ï¼Œæœ€åä¸€è¡Œæ˜¯è¿™æ ·æç¤ºæˆ‘ä»¬çš„ï¼š
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
ä¸Šé¢æŠ¥é”™çš„å†…å®¹ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š
å¦‚æœä½ è¾“å…¥çš„æ•°æ®åªæœ‰1ä¸ªç‰¹å¾ï¼Œéœ€è¦ç”¨array.reshape(-1, 1)æ¥æ”¹å˜æ•°ç»„çš„å½¢çŠ¶
shapeæ˜¯å½¢çŠ¶çš„æ„æ€ï¼Œæœ‰é¦–æ­Œå«ã€Šshape of youã€‹é‡Œé¢æŒ‡çš„æ˜¯å¥³å­©çš„èº«æä»¤äººéš¾ä»¥å¿˜è®°ã€‚åœ¨æ•°æ®é‡Œå°±æ˜¯æŒ‡æ•°æ®çš„å¤§å°ã€‚
numpyçš„reshapeå°±æ˜¯æŒ‡æ”¹å˜æ•°ç»„çš„å½¢çŠ¶ï¼Œä¸‹é¢é€šè¿‡å‡ ä¸ªæ¡ˆä¾‹ä½ å°±æ˜ç™½äº†
'''
```

```python
import numpy as np
#å®šä¹‰2è¡Œ*3åˆ—çš„æ•°ç»„
aArr = np.array([
    [1, 2, 3],
    [5, 6, 7]
])
aArr.shape
```
`(2, 3)`

```python
#æ”¹å˜æ•°ç»„å½¢æˆä¸º3è¡Œ*2åˆ—
bArr=aArr.reshape(3,2)
bArr.shape
```
`(3, 2)`

```python
'''
reshapeè¡Œçš„å‚æ•°æ˜¯-1è¡¨ç¤ºä»€ä¹ˆå‘¢ï¼Ÿä¾‹å¦‚reshape(-1,åˆ—æ•°)
å¦‚æœè¡Œçš„å‚æ•°æ˜¯-1ï¼Œå°±ä¼šæ ¹æ®æ‰€ç»™çš„åˆ—æ•°ï¼Œè‡ªåŠ¨æŒ‰ç…§åŸå§‹æ•°ç»„çš„å¤§å°å½¢æˆä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œ
ä¾‹å¦‚reshape(-1,1)å°±æ˜¯æ”¹å˜æˆ1åˆ—çš„æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„çš„é•¿åº¦æ˜¯æ ¹æ®åŸå§‹æ•°ç»„çš„å¤§å°æ¥è‡ªåŠ¨å½¢æˆçš„ã€‚
åŸå§‹æ•°ç»„æ€»å…±æ˜¯2è¡Œ*3åˆ—=6ä¸ªæ•°ï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä¼šå½¢æˆ6è¡Œ*1åˆ—çš„æ•°ç»„
'''
cArr=aArr.reshape(-1,1)
cArr.shape
```
`(6, 1)`

```python
'''
reshapeåˆ—çš„å‚æ•°æ˜¯-1è¡¨ç¤ºä»€ä¹ˆå‘¢ï¼Ÿä¾‹å¦‚reshape(è¡Œæ•°,-1)
å¦‚æœåˆ—çš„å‚æ•°æ˜¯-1ï¼Œå°±ä¼šæ ¹æ®æ‰€ç»™çš„è¡Œæ•°ï¼Œè‡ªåŠ¨æŒ‰ç…§åŸå§‹æ•°ç»„çš„å¤§å°å½¢æˆä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œ
ä¾‹å¦‚reshape(1,-1)å°±æ˜¯æ”¹å˜æˆ1è¡Œçš„æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„çš„åˆ—æ•°æ˜¯æ ¹æ®åŸå§‹æ•°ç»„çš„å¤§å°æ¥è‡ªåŠ¨å½¢æˆçš„ã€‚
åŸå§‹æ•°ç»„æ€»å…±æ˜¯2è¡Œ*3åˆ—=6ä¸ªæ•°ï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä¼šå½¢æˆ1è¡Œ*6åˆ—çš„æ•°ç»„
'''
dArr=aArr.reshape(1,-1)
dArr.shape
dArr
```
`array([[1, 2, 3, 5, 6, 7]])`

```python
'''
ç†è§£äº†reshapeåï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹é€»è¾‘å›å½’æ¨¡å‹
sklearnè¦æ±‚è¾“å…¥çš„ç‰¹å¾å¿…é¡»æ˜¯äºŒç»´æ•°ç»„çš„ç±»å‹ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬ç›®å‰åªæœ‰1ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥éœ€è¦ç”¨å®‰è£…é”™è¯¯æç¤ºç”¨reshapeè½¬è¡ŒæˆäºŒç»´æ•°ç»„çš„ç±»å‹ã€‚
é”™è¯¯æç¤ºä¿¡æ¯ï¼šReshape your data either using array.reshape(-1, 1) if your data has a single feature
'''
#å°†è®­ç»ƒæ•°æ®ç‰¹å¾è½¬æ¢æˆäºŒç»´æ•°ç»„XXè¡Œ*1åˆ—
# X_train=X_train.values.reshape(-1,1)
#å°†æµ‹è¯•æ•°æ®ç‰¹å¾è½¬æ¢æˆäºŒç»´æ•°ç»„è¡Œæ•°*1åˆ—
# X_test=X_test.values.reshape(-1,1)

#å¯¼å…¥é€»è¾‘å›å½’åŒ…
from sklearn.linear_model import LogisticRegression
# åˆ›å»ºæ¨¡å‹ï¼šé€»è¾‘å›å½’
model = LogisticRegression()
#è®­ç»ƒæ¨¡å‹
model.fit(X_train , y_train)
```

## æ¨¡å‹è¯„ä¼°

```python
#è¯„ä¼°æ¨¡å‹ï¼šå‡†ç¡®ç‡
model.score(X_test , y_test)
```
`0.75`

## é€»è¾‘å‡½æ•°

```python
#è·å–æ¦‚ç‡å€¼
#ç¬¬1ä¸ªå€¼æ˜¯æ ‡ç­¾ä¸º0çš„æ¦‚ç‡å€¼ï¼Œç¬¬2ä¸ªå€¼æ˜¯æ ‡ç­¾ä¸º1çš„æ¦‚ç‡å€¼
#model.predict_proba(3)
model.predict_proba([[3]])
```
`array([[0.46796623, 0.53203377]])`

```python
#é¢„æµ‹æ•°æ®ï¼šä½¿ç”¨æ¨¡å‹çš„predictæ–¹æ³•å¯ä»¥è¿›è¡Œé¢„æµ‹ã€‚è¿™é‡Œæˆ‘ä»¬è¾“å…¥å­¦ç”Ÿçš„ç‰¹å¾å­¦ä¹ æ—¶é—´3å°æ—¶ï¼Œæ¨¡å‹è¿”å›ç»“æœæ ‡ç­¾æ˜¯1ï¼Œè¡¨ç¤ºé¢„æµ‹è¯¥å­¦ç”Ÿé€šè¿‡è€ƒè¯•ã€‚
pred=model.predict([[3]])
print(pred)
```
`[1]`

```python
'''
ç†è§£é€»è¾‘å›å½’å‡½æ•°
æ–œç‡slope
æˆªè·intercept
'''
#ç¬¬1æ­¥ï¼šå¾—åˆ°å›å½’æ–¹ç¨‹çš„zå€¼
#å›å½’æ–¹ç¨‹ï¼šz=ğ‘+ğ‘x
#æˆªè·
a=model.intercept_
#å›å½’ç³»æ•°
b=model.coef_

x=3
z=a+b*x

#ç¬¬2æ­¥ï¼šå°†zå€¼å¸¦å…¥é€»è¾‘å›å½’å‡½æ•°ä¸­ï¼Œå¾—åˆ°æ¦‚ç‡å€¼
y_pred=1/(1+np.exp(-z))
print('é¢„æµ‹çš„æ¦‚ç‡å€¼ï¼š',y_pred)
```
`é¢„æµ‹çš„æ¦‚ç‡å€¼ï¼š [[0.53203377]]`

