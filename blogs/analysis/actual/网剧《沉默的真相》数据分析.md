---
title: 网剧《沉默的真相》数据分析
date: 2020-09-27
draft: false
tags: ["requests","pandas"]
categories: ["分析实战"]
---

最近有两部国产剧比较火，一部是《隐秘的角落》和《沉默的真相》

隐秘的角落上一篇已经写过了，可以戳[这里]()

正在热播的《沉默的真相》，豆瓣评分高达9.2分，可见颇受欢迎

![沉默的真相评分](/images/202009/22/沉默的真相评分.jpg)

接下来就网友对这部剧的评论和看法，进行简单的分析

## 数据获取

首先从豆瓣评论页面后台入口抓取网友的评论信息

沉默的真相： `https://movie.douban.com/subject/33447642/comments?start=20&limit=20&sort=new_score&status=P&comments_only=1`

## 分词

数据抓取下来后，对评论信息进行分词处理

```python
import pandas as pd

data=pd.read_excel("data.xlsx")

txt = data['Content'].str.cat(sep='。')

# 文本预处理  去除一些无用的字符   只提取出中文出来
new_data = re.findall('[\u4e00-\u9fa5]+', txt, re.S)  # 只要字符串中的中文
new_data = " ".join(new_data)

# 文本分词--精确模式
seg_list_exact = jieba.cut(new_data, cut_all=False)

result_list = []
with open('stop_words.txt', encoding='utf-8') as f:
    con = f.readlines()
    stop_words = set()
    for i in con:
        i = i.replace("\n", "")   # 去掉读取每一行数据的\n
        stop_words.add(i)

for word in seg_list_exact:
    # 设置停用词并去除单个词
    if word not in stop_words and len(word) > 1:
        result_list.append(word)
# print(result_list)

# 筛选后统计
word_counts = collections.Counter(result_list)
# 获取前100最高频的词
word_counts_top100 = word_counts.most_common(100)
# 打印出来看看统计的词频
# print(word_counts_top100)
```

## 词云图

最后进行词云图展示

```python
# 链式调用
c = (
    WordCloud(
        init_opts=opts.InitOpts(width='1000px', height='750px')
    )
    .add(
        series_name="词频",               # 系列名称
        data_pair=word_counts_top100,   # 系列数据项 [(word1, count1), (word2, count2)]
        word_size_range=[15, 108],      # 单词字体大小范围
        textstyle_opts=opts.TextStyleOpts(     # 词云图文字的配置
            font_family='KaiTi',
        ),
        shape=SymbolType.DIAMOND,  # 词云图轮廓，有 'circle', 'cardioid', 'diamond', 'triangle-forward', 'triangle', 'pentagon', 'star' 可选
        pos_left='100',  # 距离左侧的距离
        pos_top='50',    # 距离顶部的距离
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(           # 标题配置项
            title='《隐秘的角落》词云图', #分别对两部剧进行词云图展示
            title_textstyle_opts=opts.TextStyleOpts(
                font_family='SimHei',
                font_size=25,
                color='black'
            ),
#             pos_left='500',
            pos_top='10',
        ),
        tooltip_opts=opts.TooltipOpts(       # 提示框配置项
            is_show=True,
            background_color='red',
            border_color='yellow',
        ),
        toolbox_opts=opts.ToolboxOpts(       # 工具箱配置项
            is_show=True,
            orient='vertical',
        )
    )
#     .render('词云图2.html')
)
c.render_notebook()
```

![沉默的真相词云图](/images/202009/22/沉默的真相词云图.png)