---
title: 使用SQL窗口函数进行商务数据分析
date: 2020-11-26
draft: false
tags: ["sql"]
categories: ["数据库系列"]
---

新建`orders`表

```sql
create table orders(
order_id int,
customer_id varchar(50),
city varchar(50),
add_time varchar(50),
amount decimal(10,2));
```

准备数据

```sql
INSERT INTO orders VALUES
(1,"A","上海","2020-01-01 00:00:00.000000",200),
(2,"B","上海","2020-01-05 00:00:00.000000",250),
(3,"C","北京","2020-01-12 00:00:00.000000",200),
(4,"A","上海","2020-02-04 00:00:00.000000",400),
(5,"D","上海","2020-02-05 00:00:00.000000",250),
(5,"D","上海","2020-02-05 12:00:00.000000",300),
(6,"C","北京","2020-02-19 00:00:00.000000",300),
(7,"A","上海","2020-03-01 00:00:00.000000",150),
(8,"E","北京","2020-03-05 00:00:00.000000",500),
(9,"F","上海","2020-03-09 00:00:00.000000",250),
(10,"B","上海","2020-03-21 00:00:00.000000",600);
```


