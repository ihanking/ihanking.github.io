---
title: 基于纵向表合并的超市交易数据分析
date: 2020-11-16
draft: false
tags: ["sql"]
categories: ["数据库系列"]
---

`TransA1710`表结构如下
```sql
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| shop_id  | int(11)       | YES  |     | NULL    |       |
| uid      | varchar(10)   | YES  |     | NULL    |       |
| order_id | varchar(20)   | YES  |     | NULL    |       |
| date     | datetime      | YES  |     | NULL    |       |
| amt1     | decimal(10,2) | YES  |     | NULL    |       |
| amt2     | decimal(10,2) | YES  |     | NULL    |       |
| amt3     | decimal(10,2) | YES  |     | NULL    |       |
| pay_type | tinyint(4)    | YES  |     | NULL    |       |
+----------+---------------+------+-----+---------+-------+
```

`TransA1801`表结构如下
```sql
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| shop_id  | int(11)       | YES  |     | NULL    |       |
| uid      | varchar(10)   | YES  |     | NULL    |       |
| order_id | varchar(20)   | YES  |     | NULL    |       |
| date     | datetime      | YES  |     | NULL    |       |
| amt1     | decimal(10,2) | YES  |     | NULL    |       |
| amt2     | decimal(10,2) | YES  |     | NULL    |       |
| amt3     | decimal(10,2) | YES  |     | NULL    |       |
| pay_type | tinyint(4)    | YES  |     | NULL    |       |
+----------+---------------+------+-----+---------+-------+
```

`TransB1805`表结构如下
```sql

```